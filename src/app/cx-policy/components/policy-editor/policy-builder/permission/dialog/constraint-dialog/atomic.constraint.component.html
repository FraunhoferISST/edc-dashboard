<!--
    Copyright (c) 2025 Fraunhofer-Gesellschaft zur Förderung der angewandten Forschung e.V.

    This program and the accompanying materials are made available under the
    terms of the Apache License, Version 2.0 which is available at
    https://www.apache.org/licenses/LICENSE-2.0

    SPDX-License-Identifier: Apache-2.0

    Contributors:
        Fraunhofer-Gesellschaft zur Förderung der angewandten Forschung e.V. - Catena-X Next Policy Builder
-->

<div class="flex flex-col gap-y-4 items-center h-full overflow-y-auto">
  <h1 class="text-xl text-center divider my-0 2xl:col-span-2">Atomic Constraint</h1>

  <fieldset class="fieldset bg-base-300 border-base-300 rounded-box w-5xl border p-4">
    <legend class="fieldset-legend text-sm justify-start w-full">Left Operand</legend>
    <input type="text" class="input input-bordered w-full" [(ngModel)]="constraint.leftOperand" [disabled]="true" />
  </fieldset>
  <fieldset class="fieldset bg-base-300 border-base-300 rounded-box w-5xl border p-4">
    <legend class="fieldset-legend text-sm justify-start w-full"><span>Operator</span></legend>
    <select
      class="select select-bordered w-full"
      [(ngModel)]="constraint.selectedOperator"
      [disabled]="constraint.operator.length === 1"
    >
      @for (operator of constraint.operator; track operator) {
        <option [value]="operator">{{ camelCaseToWords(operator, true) }}</option>
      }
    </select>
  </fieldset>
  <fieldset class="fieldset w-5xl bg-base-300 border border-base-300 p-4 rounded-box" [formGroup]="form">
    <legend class="fieldset-legend text-sm justify-start w-full">Right Operand</legend>
    @if (rightOperand) {
      <app-right-operand [rightOperand]="rightOperand" [parentFormGroup]="form"></app-right-operand>
    } @else if (rightOperands) {
      @for (item of rightOperands; let i = $index; track item) {
        <app-right-operand
          [rightOperand]="item"
          [selectTypes]="getRightOperands()"
          (changed)="onRightOperandChange($event, i)"
          [parentFormGroup]="form"
          [deleteButton]="i > 0"
          (deleted)="onRightOperandDelete($event)"
        ></app-right-operand>
      }
      <div class="divider my-1"></div>
      <button type="button" class="btn btn-soft btn-sm btn-primary w-fit justify-self-end" (click)="addOperand()">
        <span class="material-symbols-rounded">add</span>
        Add
      </button>
    }
  </fieldset>

  <div class="divider my-0"></div>
  <button type="button" class="btn btn-lg btn-primary w-fit" (click)="onSave()" [disabled]="form.invalid">
    <span class="material-symbols-rounded">save</span>
    Save Atomic Constraint
  </button>
</div>
