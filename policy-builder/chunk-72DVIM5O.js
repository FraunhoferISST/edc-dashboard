import{$a as ie,B as w,C as g,Da as q,F as d,Fa as R,Ga as z,H as S,K as B,L as P,M as n,Ma as H,N as s,O as b,Oa as Q,Pa as pe,Qa as W,R as A,Ra as X,S as m,Sa as Y,T as p,Ta as Z,Xa as ee,Y as o,Ya as te,Z as y,_a as ne,ab as se,bb as ae,c as ce,d as v,da as E,e as $,eb as oe,fa as I,g as D,ga as T,h as C,j as k,ka as L,m as M,ma as j,na as G,o as N,p as O,r as F,s as _,t as f,va as U,w as h,xa as J,y as r,ya as K,z as x}from"./chunk-NSHOW2UM.js";var V=ce(pe(),1);var me=()=>["@context","id","name","contenttype"],ue=()=>["@context"];function _e(t,c){if(t&1){let e=A();n(0,"lib-alert",20),m("closeEvent",function(){_(e);let i=p();return f(i.errorMsg="")}),s()}if(t&2){let e=p();d("msg",e.errorMsg)}}function fe(t,c){t&1&&(n(0,"i",21),o(1,"update"),s(),o(2," Update Asset "))}function ve(t,c){t&1&&(n(0,"i",21),o(1,"add"),s(),o(2," Create Asset "))}function ge(t,c){t&1&&(n(0,"div",11)(1,"span",12),o(2,"assignment_ind"),s(),n(3,"b")(4,"i"),o(5,"Name"),s()()())}function Ce(t,c){if(t&1&&(n(0,"span",13),o(1),s()),t&2){let e=p(3);r(),y(e.name)}}function he(t,c){t&1&&(n(0,"div",11)(1,"span",12),o(2,"question_exchange"),s(),n(3,"b")(4,"i"),o(5,"Type"),s()()())}function xe(t,c){if(t&1&&(n(0,"span",13),o(1),s()),t&2){let e=p(3);r(),y(e.type)}}function be(t,c){t&1&&(n(0,"div",11)(1,"span",12),o(2,"unknown_document"),s(),n(3,"b")(4,"i"),o(5,"Content Type"),s()()())}function Ae(t,c){if(t&1&&(n(0,"span",13),o(1),s()),t&2){let e=p(3);r(),y(e.contentType)}}function ye(t,c){if(t&1&&(n(0,"div",8),g(1,ge,6,0,"div",9)(2,Ce,2,1,"span",10)(3,he,6,0,"div",9)(4,xe,2,1,"span",10)(5,be,6,0,"div",9)(6,Ae,2,1,"span",10),s()),t&2){let e=p(2);r(),d("ngIf",e.name),r(),d("ngIf",e.name),r(),d("ngIf",e.type),r(),d("ngIf",e.type),r(),d("ngIf",e.contentType),r(),d("ngIf",e.contentType)}}function we(t,c){if(t&1){let e=A();n(0,"div",14)(1,"div",15)(2,"button",16),m("click",function(){_(e);let i=p(2);return f(i.detailsEvent.emit(i.asset))}),n(3,"i",17),o(4,"info"),s()()(),n(5,"div",18)(6,"button",19),m("click",function(){_(e);let i=p(2);return f(i.editEvent.emit(i.asset))}),n(7,"i",17),o(8,"edit"),s()()(),n(9,"div",20)(10,"button",21),m("click",function(){_(e);let i=p(2);return f(i.deleteEvent.emit(i.asset))}),n(11,"i",17),o(12,"delete"),s()()()()}}function Se(t,c){if(t&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"span",4),o(4,"deployed_code_update"),s(),n(5,"span",5),o(6),s()(),g(7,ye,7,6,"div",6)(8,we,13,0,"div",7),s()()),t&2){let e=p();r(6),y(e.asset.id),r(),d("ngIf",e.name||e.type||e.contentType),r(),d("ngIf",e.showButtons)}}var Ee=()=>["Alt","j"],Ie=(t,c)=>c.id;function Te(t,c){if(t&1){let e=A();n(0,"lib-asset-card",9),m("detailsEvent",function(i){_(e);let l=p();return f(l.openDetails(i))})("editEvent",function(i){_(e);let l=p();return f(l.editAsset(i))})("deleteEvent",function(i){_(e);let l=p();return f(l.deleteAsset(i))}),s()}if(t&2){let e=c.$implicit;d("asset",e)}}function Ve(t,c){t&1&&b(0,"span",10)}function Fe(t,c){if(t&1){let e=A();n(0,"div",11)(1,"button",12),m("click",function(){_(e);let i=p(2);return f(i.createAsset())}),n(2,"span",3),o(3,"add"),s(),o(4," Create "),s()()}}function je(t,c){if(t&1&&(n(0,"div",8),g(1,Ve,1,0,"span",10)(2,Fe,5,0,"div",11),s()),t&2){let e=p();r(),S(e.fetched?2:1)}}var de=(()=>{class t{edc;constructor(e){this.edc=e}getAllAssets(){return v(this,null,function*(){return(yield this.edc.getClient()).management.assets.queryAll()})}createAsset(e){return v(this,null,function*(){return(yield this.edc.getClient()).management.assets.create(e)})}updateAsset(e){return v(this,null,function*(){return(yield this.edc.getClient()).management.assets.update(e)})}deleteAsset(e){return v(this,null,function*(){return(yield this.edc.getClient()).management.assets.delete(e)})}static \u0275fac=function(a){return new(a||t)(O(W))};static \u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),re=(()=>{class t{assetService;formBuilder;asset;created=new h;updated=new h;mode="create";errorMsg="";properties={};privateProperties={};dataAddress;assetForm;constructor(e,a){this.assetService=e,this.formBuilder=a,this.assetForm=this.formBuilder.group({id:[""],name:[""],contenttype:[""]})}ngOnChanges(){return v(this,null,function*(){this.asset&&(this.mode="update",yield this.updateAssetAndSyncForm(),this.assetForm.get("id")?.disable())})}updateAssetAndSyncForm(){return v(this,null,function*(){this.properties=yield(0,V.compact)(this.asset.properties),this.privateProperties=yield(0,V.compact)(this.asset.privateProperties),this.dataAddress=yield(0,V.compact)(this.asset.dataAddress),this.assetForm.get("id")?.setValue(this.asset.id),this.assetForm.get("name")?.setValue(this.properties.name),this.assetForm.get("contenttype")?.setValue(this.properties.contenttype)})}createAsset(){if(this.assetForm.valid){let e=this.createAssetInput();this.mode==="create"?this.assetService.createAsset(e).then(a=>{this.created.emit(a)}).catch(a=>{this.errorMsg=a.message}):this.mode==="update"&&this.assetService.updateAsset(e).then(()=>this.updated.emit()).catch(a=>this.errorMsg=a.message)}else console.error("Create asset called with invalid form")}createAssetInput(){let e={dataAddress:this.dataAddress,properties:this.properties,privateProperties:this.privateProperties};return this.assetForm.value.id&&(e["@id"]=this.assetForm.value.id),this.assetForm.value.name&&(e.properties.name=this.assetForm.value.name),this.assetForm.value.contenttype&&(e.properties.contenttype=this.assetForm.value.contenttype),e}static \u0275fac=function(a){return new(a||t)(x(de),x(H))};static \u0275cmp=w({type:t,selectors:[["lib-asset-create"]],inputs:{asset:"asset"},outputs:{created:"created",updated:"updated"},features:[F],decls:50,vars:13,consts:[[1,"grid","grid-cols-1","2xl:grid-cols-2","gap-4","gap-x-6","items-start","overflow-y-auto","h-full","[&_label]:shrink-0",3,"ngSubmit","formGroup"],[1,"text-xl","text-center","divider","m-0","2xl:col-span-2"],[1,"flex","flex-col","[&_>*]:mb-4","[&_>*]:last:mb-0"],[1,"fieldset","w-lg","bg-base-200","border","border-base-300","p-4","rounded-box"],[1,"fieldset-legend","text-sm"],[1,"fieldset-label"],["data-tip","If not set a random UUID will be generated",1,"input","input-bordered","!border-[var(--input-color)]","flex","items-center","tooltip","tooltip-info","tooltip-top","w-full"],[1,"material-symbols-rounded","opacity-50"],["type","text","placeholder","ID","formControlName","id","name","id",1,"grow"],[1,"badge","badge-info"],["data-tip","Can be filtered by and could be used as e.g. display name",1,"input","flex","items-center","tooltip","tooltip-info","tooltip-top","w-full"],["type","text","placeholder","Name","formControlName","name",1,"grow"],["data-tip","Content-Type of the asset, e.g. 'application/json'",1,"input","flex","items-center","tooltip","tooltip-info","tooltip-top","w-full"],["type","text","placeholder","Content-Type","formControlName","contenttype","name","contenttype",1,"grow"],[3,"dataAddressChange","parentForm","dataAddress"],[3,"objectChange","object","excludeKeys"],[1,"2xl:col-span-2","flex","flex-col","items-center"],[1,"divider","mt-0"],["title","Error","type","error","class","max-w-lg 2xl:max-w-xl mb-4",3,"msg","closeEvent",4,"ngIf"],["type","submit",1,"btn","btn-lg","w-lg","2xl:w-xl",3,"disabled","ngClass"],["title","Error","type","error",1,"max-w-lg","2xl:max-w-xl","mb-4",3,"closeEvent","msg"],[1,"material-symbols-rounded"]],template:function(a,i){a&1&&(n(0,"form",0),m("ngSubmit",function(){return i.createAsset()}),n(1,"h1",1),o(2,"Asset"),s(),n(3,"div",2)(4,"fieldset",3)(5,"legend",4),o(6,"Common Fields"),s(),n(7,"legend",5),o(8,"ID"),s(),n(9,"label",6)(10,"span",7),o(11,"deployed_code_update"),s(),b(12,"input",8),n(13,"span",9),o(14,"Optional"),s()(),n(15,"legend",5),o(16,"Name"),s(),n(17,"label",10)(18,"span",7),o(19,"assignment_ind"),s(),b(20,"input",11),n(21,"span",9),o(22,"Optional"),s()(),n(23,"legend",5),o(24,"Content-Type"),s(),n(25,"label",12)(26,"span",7),o(27,"unknown_document"),s(),b(28,"input",13),n(29,"span",9),o(30,"Optional"),s()()(),n(31,"fieldset",3)(32,"legend",4),o(33,"Data Address"),s(),n(34,"lib-data-address-form",14),m("dataAddressChange",function(u){return i.dataAddress=u}),s()()(),n(35,"div",2)(36,"fieldset",3)(37,"legend",4),o(38,"Properties"),s(),n(39,"lib-json-object-input",15),m("objectChange",function(u){return i.properties=u}),s()(),n(40,"fieldset",3)(41,"legend",4),o(42,"Private Properties"),s(),n(43,"lib-json-object-input",15),m("objectChange",function(u){return i.privateProperties=u}),s()()(),n(44,"div",16),b(45,"div",17),g(46,_e,1,1,"lib-alert",18),n(47,"button",19),g(48,fe,3,0)(49,ve,3,0),s()()()),a&2&&(d("formGroup",i.assetForm),r(34),d("parentForm",i.assetForm)("dataAddress",i.dataAddress),r(5),d("object",i.properties)("excludeKeys",E(11,me)),r(4),d("object",i.privateProperties)("excludeKeys",E(12,ue)),r(3),d("ngIf",i.errorMsg),r(),d("disabled",i.assetForm.invalid)("ngClass",i.mode==="update"?"btn-warning":"btn-primary"),r(),S(i.mode==="update"?48:49))},dependencies:[Q,q,U,J,K,R,z,j,Y,L,ee,oe],encapsulation:2})}return t})(),le=(()=>{class t{asset;showButtons=!0;detailsEvent=new h;editEvent=new h;deleteEvent=new h;name;type;contentType;ngOnChanges(){this.name=this.asset?.properties.optionalValue("edc","name"),this.contentType=this.asset?.properties.optionalValue("edc","contenttype"),this.type=this.asset?.dataAddress.mandatoryValue("edc","type")}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=w({type:t,selectors:[["lib-asset-card"]],inputs:{asset:"asset",showButtons:"showButtons"},outputs:{detailsEvent:"detailsEvent",editEvent:"editEvent",deleteEvent:"deleteEvent"},features:[F],decls:1,vars:1,consts:[["class","card grow bg-base-300",4,"ngIf"],[1,"card","grow","bg-base-300"],[1,"card-body"],[1,"card-title","mb-3"],[1,"material-symbols-rounded","!text-3xl"],[1,"truncate","text-wrap"],["class","ml-3 mb-3 grid grid-cols-[minmax(0,auto)_minmax(0,min-content)] gap-4",4,"ngIf"],["class","card-actions justify-end mt-auto",4,"ngIf"],[1,"ml-3","mb-3","grid","grid-cols-[minmax(0,auto)_minmax(0,min-content)]","gap-4"],["class","flex items-center",4,"ngIf"],["class","truncate",4,"ngIf"],[1,"flex","items-center"],[1,"material-symbols-rounded","mr-1"],[1,"truncate"],[1,"card-actions","justify-end","mt-auto"],["data-tip","Details",1,"tooltip","no-animation"],[1,"btn","btn-soft","btn-primary","btn-circle","btn-sm","no-animation",3,"click"],[1,"material-symbols-rounded"],["data-tip","Edit",1,"tooltip","no-animation"],[1,"btn","btn-soft","btn-warning","btn-circle","btn-sm","no-animation",3,"click"],["data-tip","Delete",1,"tooltip","no-animation"],[1,"btn","btn-soft","btn-error","btn-circle","btn-sm",3,"click"]],template:function(a,i){a&1&&g(0,Se,9,3,"div",0),a&2&&d("ngIf",i.asset)},dependencies:[j],encapsulation:2})}return t})(),Re=(()=>{class t{assetService;modalAndAlertService;stateService;destroy$=new $;assets$=C([]);filteredAssets$=C([]);pageAssets$=C([]);fetched=!1;pageItemCount=15;constructor(e,a,i){this.assetService=e,this.modalAndAlertService=a,this.stateService=i,this.stateService.currentEdcConfig$.pipe(M(this.destroy$)).subscribe(this.fetchAssets.bind(this))}ngOnInit(){return v(this,null,function*(){this.fetchAssets()})}filter(e){if(e){let a=e.toLowerCase();this.filteredAssets$=this.assets$.pipe(k(i=>i.filter(l=>l.id.includes(e)||l.properties.optionalValue("edc","name")?.toLowerCase().includes(a)||l.properties.optionalValue("edc","contenttype")?.toLowerCase().includes(a)||l.dataAddress.mandatoryValue("edc","type").toLowerCase().includes(a))))}else this.filteredAssets$=this.assets$}paginationEvent(e){this.pageAssets$=C(e)}createAsset(){let e={created:a=>{this.modalAndAlertService.closeModal(),this.modalAndAlertService.showAlert(`Asset with ID '${a.id}'`,"created successfully","success",5),this.fetchAssets()}};this.modalAndAlertService.openModal(re,void 0,e)}editAsset(e){let a={updated:()=>{this.modalAndAlertService.closeModal(),this.modalAndAlertService.showAlert(`Asset with ID '${e.id}'`,"updated successfully","success",5),this.fetchAssets()}};this.modalAndAlertService.openModal(re,{asset:e},a)}deleteAsset(e){this.modalAndAlertService.openModal(te,{customText:"Do you really want to delete this Asset?",componentType:le,componentInputs:{asset:e,showButtons:!1}},{canceled:()=>this.modalAndAlertService.closeModal(),confirm:()=>{this.modalAndAlertService.closeModal(),this.assetService.deleteAsset(e.id).then(()=>{let a=`Asset '${e.id}' deleted successfully`;this.modalAndAlertService.showAlert(a,void 0,"success",5),this.fetchAssets()}).catch(a=>{console.error(a);let i=`Deletion of asset '${e.id}' failed`;this.modalAndAlertService.showAlert(i,void 0,"error",5)})}})}openDetails(e){this.modalAndAlertService.openModal(ne,{jsonLdObject:e})}fetchAssets(){this.fetched=!1,this.assets$=this.filteredAssets$=C([]),this.assets$=this.filteredAssets$=D(this.assetService.getAllAssets().finally(()=>this.fetched=!0))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(x(de),x(Z),x(X))};static \u0275cmp=w({type:t,selectors:[["lib-asset-view"]],decls:15,vars:12,consts:[[1,"flex-row","flex-nowrap","flex","mb-4"],["placeholder","Filter for ID, Name, Type or Content Type ...",1,"mr-4","grow",3,"inputChange","focusShortcut"],[1,"mr-4","btn","btn-lg","btn-primary","rounded-2xl","btn-soft","shadow-xl","!text-sm","border-none",3,"click"],[1,"material-symbols-rounded"],[1,"mr-4",3,"itemCountChanged","currentItemCount"],[1,"shadow-xl","rounded-2xl","bg-base-300","[&_button:hover]:bg-base-100","[&_.join>button]:first:rounded-l-2xl","[&_.join>button]:last:rounded-r-2xl",3,"pageItems","items","pageItemCount"],[1,"grid","w-full","gap-4","sm:grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","2xl:grid-cols-5"],[1,"rounded-2xl","shadow-xl","[&_>.card]:h-full",3,"asset"],[1,"skeleton","flex","justify-center","items-center","h-72","shadow-xl","rounded-2xl"],[1,"rounded-2xl","shadow-xl","[&_>.card]:h-full",3,"detailsEvent","editEvent","deleteEvent","asset"],[1,"loading","loading-bars","loading-lg","opacity-75","text-primary"],["data-tip","No assets yet! Create your first ...",1,"tooltip","tooltip-open","tooltip-primary"],[1,"btn","btn-primary","btn-dash",3,"click"]],template:function(a,i){if(a&1&&(n(0,"div",0)(1,"lib-filter-input",1),m("inputChange",function(u){return i.filter(u)}),s(),n(2,"button",2),m("click",function(){return i.createAsset()}),n(3,"span",3),o(4,"add"),s(),o(5," Create "),s(),n(6,"lib-item-count-selector",4),m("itemCountChanged",function(u){return i.pageItemCount=u}),s(),n(7,"lib-pagination",5),I(8,"async"),m("pageItems",function(u){return i.paginationEvent(u)}),s()(),n(9,"div",6),B(10,Te,1,1,"lib-asset-card",7,Ie),I(12,"async"),g(13,je,3,1,"div",8),I(14,"async"),s()),a&2){let l;r(),d("focusShortcut",E(11,Ee)),r(5),d("currentItemCount",i.pageItemCount),r(),d("items",T(8,5,i.filteredAssets$))("pageItemCount",i.pageItemCount),r(3),P(T(12,7,i.pageAssets$)),r(3),S(((l=T(14,9,i.assets$))==null?null:l.length)==0?13:-1)}},dependencies:[G,ie,se,le,ae],encapsulation:2})}return t})();export{de as a,le as b,Re as c};
